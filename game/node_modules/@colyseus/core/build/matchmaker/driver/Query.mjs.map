{"version":3,"file":"Query.mjs","sources":["../../../src/matchmaker/driver/Query.ts"],"sourcesContent":["import { QueryHelpers, SortOptions } from './interfaces';\n\nexport class Query<T> implements QueryHelpers<T> {\n  private $rooms: T[];\n  private conditions: any;\n\n  constructor(rooms: any[], conditions) {\n    this.$rooms = rooms.slice(0);\n    this.conditions = conditions;\n  }\n\n  public sort(options: SortOptions) {\n    this.$rooms = this.$rooms.sort((room1, room2) => {\n      for (const field in options) {\n        if (options.hasOwnProperty(field)) {\n          const direction = options[field];\n          const isAscending = (direction === 1 || direction === 'asc' || direction === 'ascending');\n\n          if (isAscending) {\n            if (room1[field] > room2[field]) { return 1; }\n            if (room1[field] < room2[field]) { return -1; }\n\n          } else {\n            if (room1[field] > room2[field]) { return -1; }\n            if (room1[field] < room2[field]) { return 1; }\n          }\n        }\n      }\n    });\n  }\n\n  public then(resolve, reject) {\n    const result: any = this.$rooms.find(((room) => {\n      for (const field in this.conditions) {\n        if (\n          this.conditions.hasOwnProperty(field) &&\n          room[field] !== this.conditions[field]\n        ) {\n          return false;\n        }\n      }\n      return true;\n    }));\n    return resolve(result);\n  }\n}\n"],"names":[],"mappings":"MAEa,KAAK;IACR,MAAM,CAAM;IACZ,UAAU,CAAM;IAExB,YAAY,KAAY,EAAE,UAAU;QAClC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QAC7B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;KAC9B;IAEM,IAAI,CAAC,OAAoB;QAC9B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,KAAK,EAAE,KAAK;YAC1C,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE;gBAC3B,IAAI,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;oBACjC,MAAM,SAAS,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;oBACjC,MAAM,WAAW,IAAI,SAAS,KAAK,CAAC,IAAI,SAAS,KAAK,KAAK,IAAI,SAAS,KAAK,WAAW,CAAC,CAAC;oBAE1F,IAAI,WAAW,EAAE;wBACf,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,EAAE;4BAAE,OAAO,CAAC,CAAC;yBAAE;wBAC9C,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,EAAE;4BAAE,OAAO,CAAC,CAAC,CAAC;yBAAE;qBAEhD;yBAAM;wBACL,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,EAAE;4BAAE,OAAO,CAAC,CAAC,CAAC;yBAAE;wBAC/C,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,KAAK,CAAC,EAAE;4BAAE,OAAO,CAAC,CAAC;yBAAE;qBAC/C;iBACF;aACF;SACF,CAAC,CAAC;KACJ;IAEM,IAAI,CAAC,OAAO,EAAE,MAAM;QACzB,MAAM,MAAM,GAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC,IAAI;YACzC,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,UAAU,EAAE;gBACnC,IACE,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,KAAK,CAAC;oBACrC,IAAI,CAAC,KAAK,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,EACtC;oBACA,OAAO,KAAK,CAAC;iBACd;aACF;YACD,OAAO,IAAI,CAAC;SACb,EAAE,CAAC;QACJ,OAAO,OAAO,CAAC,MAAM,CAAC,CAAC;KACxB;;;;;"}
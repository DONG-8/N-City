{"version":3,"file":"hiredis.js","sources":["../../../../../../node_modules/redis-parser/lib/hiredis.js"],"sourcesContent":["'use strict'\n\nvar hiredis = require('hiredis')\nvar ReplyError = require('../lib/replyError')\nvar ParserError = require('../lib/parserError')\n\n/**\n * Parse data\n * @param parser\n * @returns {*}\n */\nfunction parseData (parser, data) {\n  try {\n    return parser.reader.get()\n  } catch (err) {\n    // Protocol errors land here\n    // Reset the parser. Otherwise new commands can't be processed properly\n    parser.reader = new hiredis.Reader(parser.options)\n    parser.returnFatalError(new ParserError(err.message, JSON.stringify(data), -1))\n  }\n}\n\n/**\n * Hiredis Parser\n * @param options\n * @constructor\n */\nfunction HiredisReplyParser (options) {\n  this.returnError = options.returnError\n  this.returnFatalError = options.returnFatalError || options.returnError\n  this.returnReply = options.returnReply\n  this.name = 'hiredis'\n  this.options = {\n    return_buffers: !!options.returnBuffers\n  }\n  this.reader = new hiredis.Reader(this.options)\n}\n\nHiredisReplyParser.prototype.execute = function (data) {\n  this.reader.feed(data)\n  var reply = parseData(this, data)\n\n  while (reply !== undefined) {\n    if (reply && reply.name === 'Error') {\n      this.returnError(new ReplyError(reply.message))\n    } else {\n      this.returnReply(reply)\n    }\n    reply = parseData(this, data)\n  }\n}\n\n/**\n * Reset the parser values to the initial state\n *\n * @returns {undefined}\n */\nHiredisReplyParser.prototype.reset = function () {\n  this.reader = new hiredis.Reader(this.options)\n}\n\nmodule.exports = HiredisReplyParser\n"],"names":["hiredis","ParserError","ReplyError"],"mappings":";;;;;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA,SAAS,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE;AAClC,EAAE,IAAI;AACN,IAAI,OAAO,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE;AAC9B,GAAG,CAAC,OAAO,GAAG,EAAE;AAChB;AACA;AACA,IAAI,MAAM,CAAC,MAAM,GAAG,IAAIA,2BAAO,CAAC,MAAM,CAAC,MAAM,CAAC,OAAO,EAAC;AACtD,IAAI,MAAM,CAAC,gBAAgB,CAAC,IAAIC,WAAW,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,EAAC;AACnF,GAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,kBAAkB,EAAE,OAAO,EAAE;AACtC,EAAE,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,YAAW;AACxC,EAAE,IAAI,CAAC,gBAAgB,GAAG,OAAO,CAAC,gBAAgB,IAAI,OAAO,CAAC,YAAW;AACzE,EAAE,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,YAAW;AACxC,EAAE,IAAI,CAAC,IAAI,GAAG,UAAS;AACvB,EAAE,IAAI,CAAC,OAAO,GAAG;AACjB,IAAI,cAAc,EAAE,CAAC,CAAC,OAAO,CAAC,aAAa;AAC3C,IAAG;AACH,EAAE,IAAI,CAAC,MAAM,GAAG,IAAID,2BAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAC;AAChD,CAAC;AACD;AACA,kBAAkB,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,IAAI,EAAE;AACvD,EAAE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAC;AACxB,EAAE,IAAI,KAAK,GAAG,SAAS,CAAC,IAAI,EAAE,IAAI,EAAC;AACnC;AACA,EAAE,OAAO,KAAK,KAAK,SAAS,EAAE;AAC9B,IAAI,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,EAAE;AACzC,MAAM,IAAI,CAAC,WAAW,CAAC,IAAIE,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC,EAAC;AACrD,KAAK,MAAM;AACX,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,EAAC;AAC7B,KAAK;AACL,IAAI,KAAK,GAAG,SAAS,CAAC,IAAI,EAAE,IAAI,EAAC;AACjC,GAAG;AACH,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;AACjD,EAAE,IAAI,CAAC,MAAM,GAAG,IAAIF,2BAAO,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAC;AAChD,EAAC;AACD;aACc,GAAG;;;;"}
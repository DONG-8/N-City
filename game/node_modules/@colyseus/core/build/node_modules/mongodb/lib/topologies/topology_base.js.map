{"version":3,"file":"topology_base.js","sources":["../../../../../../../node_modules/mongodb/lib/topologies/topology_base.js"],"sourcesContent":["'use strict';\n\nconst EventEmitter = require('events'),\n  MongoError = require('../core').MongoError,\n  f = require('util').format,\n  ReadPreference = require('../core').ReadPreference,\n  ClientSession = require('../core').Sessions.ClientSession;\n\n// The store of ops\nvar Store = function(topology, storeOptions) {\n  var self = this;\n  var storedOps = [];\n  storeOptions = storeOptions || { force: false, bufferMaxEntries: -1 };\n\n  // Internal state\n  this.s = {\n    storedOps: storedOps,\n    storeOptions: storeOptions,\n    topology: topology\n  };\n\n  Object.defineProperty(this, 'length', {\n    enumerable: true,\n    get: function() {\n      return self.s.storedOps.length;\n    }\n  });\n};\n\nStore.prototype.add = function(opType, ns, ops, options, callback) {\n  if (this.s.storeOptions.force) {\n    return callback(MongoError.create({ message: 'db closed by application', driver: true }));\n  }\n\n  if (this.s.storeOptions.bufferMaxEntries === 0) {\n    return callback(\n      MongoError.create({\n        message: f(\n          'no connection available for operation and number of stored operation > %s',\n          this.s.storeOptions.bufferMaxEntries\n        ),\n        driver: true\n      })\n    );\n  }\n\n  if (\n    this.s.storeOptions.bufferMaxEntries > 0 &&\n    this.s.storedOps.length > this.s.storeOptions.bufferMaxEntries\n  ) {\n    while (this.s.storedOps.length > 0) {\n      var op = this.s.storedOps.shift();\n      op.c(\n        MongoError.create({\n          message: f(\n            'no connection available for operation and number of stored operation > %s',\n            this.s.storeOptions.bufferMaxEntries\n          ),\n          driver: true\n        })\n      );\n    }\n\n    return;\n  }\n\n  this.s.storedOps.push({ t: opType, n: ns, o: ops, op: options, c: callback });\n};\n\nStore.prototype.addObjectAndMethod = function(opType, object, method, params, callback) {\n  if (this.s.storeOptions.force) {\n    return callback(MongoError.create({ message: 'db closed by application', driver: true }));\n  }\n\n  if (this.s.storeOptions.bufferMaxEntries === 0) {\n    return callback(\n      MongoError.create({\n        message: f(\n          'no connection available for operation and number of stored operation > %s',\n          this.s.storeOptions.bufferMaxEntries\n        ),\n        driver: true\n      })\n    );\n  }\n\n  if (\n    this.s.storeOptions.bufferMaxEntries > 0 &&\n    this.s.storedOps.length > this.s.storeOptions.bufferMaxEntries\n  ) {\n    while (this.s.storedOps.length > 0) {\n      var op = this.s.storedOps.shift();\n      op.c(\n        MongoError.create({\n          message: f(\n            'no connection available for operation and number of stored operation > %s',\n            this.s.storeOptions.bufferMaxEntries\n          ),\n          driver: true\n        })\n      );\n    }\n\n    return;\n  }\n\n  this.s.storedOps.push({ t: opType, m: method, o: object, p: params, c: callback });\n};\n\nStore.prototype.flush = function(err) {\n  while (this.s.storedOps.length > 0) {\n    this.s.storedOps\n      .shift()\n      .c(\n        err ||\n          MongoError.create({ message: f('no connection available for operation'), driver: true })\n      );\n  }\n};\n\nvar primaryOptions = ['primary', 'primaryPreferred', 'nearest', 'secondaryPreferred'];\nvar secondaryOptions = ['secondary', 'secondaryPreferred'];\n\nStore.prototype.execute = function(options) {\n  options = options || {};\n  // Get current ops\n  var ops = this.s.storedOps;\n  // Reset the ops\n  this.s.storedOps = [];\n\n  // Unpack options\n  var executePrimary = typeof options.executePrimary === 'boolean' ? options.executePrimary : true;\n  var executeSecondary =\n    typeof options.executeSecondary === 'boolean' ? options.executeSecondary : true;\n\n  // Execute all the stored ops\n  while (ops.length > 0) {\n    var op = ops.shift();\n\n    if (op.t === 'cursor') {\n      if (executePrimary && executeSecondary) {\n        op.o[op.m].apply(op.o, op.p);\n      } else if (\n        executePrimary &&\n        op.o.options &&\n        op.o.options.readPreference &&\n        primaryOptions.indexOf(op.o.options.readPreference.mode) !== -1\n      ) {\n        op.o[op.m].apply(op.o, op.p);\n      } else if (\n        !executePrimary &&\n        executeSecondary &&\n        op.o.options &&\n        op.o.options.readPreference &&\n        secondaryOptions.indexOf(op.o.options.readPreference.mode) !== -1\n      ) {\n        op.o[op.m].apply(op.o, op.p);\n      }\n    } else if (op.t === 'auth') {\n      this.s.topology[op.t].apply(this.s.topology, op.o);\n    } else {\n      if (executePrimary && executeSecondary) {\n        this.s.topology[op.t](op.n, op.o, op.op, op.c);\n      } else if (\n        executePrimary &&\n        op.op &&\n        op.op.readPreference &&\n        primaryOptions.indexOf(op.op.readPreference.mode) !== -1\n      ) {\n        this.s.topology[op.t](op.n, op.o, op.op, op.c);\n      } else if (\n        !executePrimary &&\n        executeSecondary &&\n        op.op &&\n        op.op.readPreference &&\n        secondaryOptions.indexOf(op.op.readPreference.mode) !== -1\n      ) {\n        this.s.topology[op.t](op.n, op.o, op.op, op.c);\n      }\n    }\n  }\n};\n\nStore.prototype.all = function() {\n  return this.s.storedOps;\n};\n\n// Server capabilities\nvar ServerCapabilities = function(ismaster) {\n  var setup_get_property = function(object, name, value) {\n    Object.defineProperty(object, name, {\n      enumerable: true,\n      get: function() {\n        return value;\n      }\n    });\n  };\n\n  // Capabilities\n  var aggregationCursor = false;\n  var writeCommands = false;\n  var textSearch = false;\n  var authCommands = false;\n  var listCollections = false;\n  var listIndexes = false;\n  var maxNumberOfDocsInBatch = ismaster.maxWriteBatchSize || 1000;\n  var commandsTakeWriteConcern = false;\n  var commandsTakeCollation = false;\n\n  if (ismaster.minWireVersion >= 0) {\n    textSearch = true;\n  }\n\n  if (ismaster.maxWireVersion >= 1) {\n    aggregationCursor = true;\n    authCommands = true;\n  }\n\n  if (ismaster.maxWireVersion >= 2) {\n    writeCommands = true;\n  }\n\n  if (ismaster.maxWireVersion >= 3) {\n    listCollections = true;\n    listIndexes = true;\n  }\n\n  if (ismaster.maxWireVersion >= 5) {\n    commandsTakeWriteConcern = true;\n    commandsTakeCollation = true;\n  }\n\n  // If no min or max wire version set to 0\n  if (ismaster.minWireVersion == null) {\n    ismaster.minWireVersion = 0;\n  }\n\n  if (ismaster.maxWireVersion == null) {\n    ismaster.maxWireVersion = 0;\n  }\n\n  // Map up read only parameters\n  setup_get_property(this, 'hasAggregationCursor', aggregationCursor);\n  setup_get_property(this, 'hasWriteCommands', writeCommands);\n  setup_get_property(this, 'hasTextSearch', textSearch);\n  setup_get_property(this, 'hasAuthCommands', authCommands);\n  setup_get_property(this, 'hasListCollectionsCommand', listCollections);\n  setup_get_property(this, 'hasListIndexesCommand', listIndexes);\n  setup_get_property(this, 'minWireVersion', ismaster.minWireVersion);\n  setup_get_property(this, 'maxWireVersion', ismaster.maxWireVersion);\n  setup_get_property(this, 'maxNumberOfDocsInBatch', maxNumberOfDocsInBatch);\n  setup_get_property(this, 'commandsTakeWriteConcern', commandsTakeWriteConcern);\n  setup_get_property(this, 'commandsTakeCollation', commandsTakeCollation);\n};\n\nclass TopologyBase extends EventEmitter {\n  constructor() {\n    super();\n    this.setMaxListeners(Infinity);\n  }\n\n  // Sessions related methods\n  hasSessionSupport() {\n    return this.logicalSessionTimeoutMinutes != null;\n  }\n\n  startSession(options, clientOptions) {\n    const session = new ClientSession(this, this.s.sessionPool, options, clientOptions);\n\n    session.once('ended', () => {\n      this.s.sessions.delete(session);\n    });\n\n    this.s.sessions.add(session);\n    return session;\n  }\n\n  endSessions(sessions, callback) {\n    return this.s.coreTopology.endSessions(sessions, callback);\n  }\n\n  get clientMetadata() {\n    return this.s.coreTopology.s.options.metadata;\n  }\n\n  // Server capabilities\n  capabilities() {\n    if (this.s.sCapabilities) return this.s.sCapabilities;\n    if (this.s.coreTopology.lastIsMaster() == null) return null;\n    this.s.sCapabilities = new ServerCapabilities(this.s.coreTopology.lastIsMaster());\n    return this.s.sCapabilities;\n  }\n\n  // Command\n  command(ns, cmd, options, callback) {\n    this.s.coreTopology.command(ns.toString(), cmd, ReadPreference.translate(options), callback);\n  }\n\n  // Insert\n  insert(ns, ops, options, callback) {\n    this.s.coreTopology.insert(ns.toString(), ops, options, callback);\n  }\n\n  // Update\n  update(ns, ops, options, callback) {\n    this.s.coreTopology.update(ns.toString(), ops, options, callback);\n  }\n\n  // Remove\n  remove(ns, ops, options, callback) {\n    this.s.coreTopology.remove(ns.toString(), ops, options, callback);\n  }\n\n  // IsConnected\n  isConnected(options) {\n    options = options || {};\n    options = ReadPreference.translate(options);\n\n    return this.s.coreTopology.isConnected(options);\n  }\n\n  // IsDestroyed\n  isDestroyed() {\n    return this.s.coreTopology.isDestroyed();\n  }\n\n  // Cursor\n  cursor(ns, cmd, options) {\n    options = options || {};\n    options = ReadPreference.translate(options);\n    options.disconnectHandler = this.s.store;\n    options.topology = this;\n\n    return this.s.coreTopology.cursor(ns, cmd, options);\n  }\n\n  lastIsMaster() {\n    return this.s.coreTopology.lastIsMaster();\n  }\n\n  selectServer(selector, options, callback) {\n    return this.s.coreTopology.selectServer(selector, options, callback);\n  }\n\n  /**\n   * Unref all sockets\n   * @method\n   */\n  unref() {\n    return this.s.coreTopology.unref();\n  }\n\n  /**\n   * All raw connections\n   * @method\n   * @return {array}\n   */\n  connections() {\n    return this.s.coreTopology.connections();\n  }\n\n  close(forceClosed, callback) {\n    // If we have sessions, we want to individually move them to the session pool,\n    // and then send a single endSessions call.\n    this.s.sessions.forEach(session => session.endSession());\n\n    if (this.s.sessionPool) {\n      this.s.sessionPool.endAllPooledSessions();\n    }\n\n    // We need to wash out all stored processes\n    if (forceClosed === true) {\n      this.s.storeOptions.force = forceClosed;\n      this.s.store.flush();\n    }\n\n    this.s.coreTopology.destroy(\n      {\n        force: typeof forceClosed === 'boolean' ? forceClosed : false\n      },\n      callback\n    );\n  }\n}\n\n// Properties\nObject.defineProperty(TopologyBase.prototype, 'bson', {\n  enumerable: true,\n  get: function() {\n    return this.s.coreTopology.s.bson;\n  }\n});\n\nObject.defineProperty(TopologyBase.prototype, 'parserType', {\n  enumerable: true,\n  get: function() {\n    return this.s.coreTopology.parserType;\n  }\n});\n\nObject.defineProperty(TopologyBase.prototype, 'logicalSessionTimeoutMinutes', {\n  enumerable: true,\n  get: function() {\n    return this.s.coreTopology.logicalSessionTimeoutMinutes;\n  }\n});\n\nObject.defineProperty(TopologyBase.prototype, 'type', {\n  enumerable: true,\n  get: function() {\n    return this.s.coreTopology.type;\n  }\n});\n\nexports.Store = Store;\nexports.ServerCapabilities = ServerCapabilities;\nexports.TopologyBase = TopologyBase;\n"],"names":["require$$0","require$$1","EventEmitter"],"mappings":"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"}
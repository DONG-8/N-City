{"version":3,"file":"find.mjs","sources":["../../../../../../../node_modules/mongodb/lib/operations/find.js"],"sourcesContent":["'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\nconst Aspect = require('./operation').Aspect;\nconst defineAspects = require('./operation').defineAspects;\nconst ReadPreference = require('../core').ReadPreference;\nconst maxWireVersion = require('../core/utils').maxWireVersion;\nconst MongoError = require('../core/error').MongoError;\n\nclass FindOperation extends OperationBase {\n  constructor(collection, ns, command, options) {\n    super(options);\n\n    this.ns = ns;\n    this.cmd = command;\n    this.readPreference = ReadPreference.resolve(collection, this.options);\n  }\n\n  execute(server, callback) {\n    // copied from `CommandOperationV2`, to be subclassed in the future\n    this.server = server;\n\n    // updates readPreference if setReadPreference was called on the cursor\n    this.readPreference = ReadPreference.resolve(this, this.options);\n\n    if (typeof this.cmd.allowDiskUse !== 'undefined' && maxWireVersion(server) < 4) {\n      callback(new MongoError('The `allowDiskUse` option is not supported on MongoDB < 3.2'));\n      return;\n    }\n\n    if (this.explain) {\n      // We need to manually ensure explain is in the options.\n      this.options.explain = this.explain.verbosity;\n    }\n\n    // TOOD: use `MongoDBNamespace` through and through\n    const cursorState = this.cursorState || {};\n    server.query(this.ns.toString(), this.cmd, cursorState, this.options, callback);\n  }\n}\n\ndefineAspects(FindOperation, [\n  Aspect.READ_OPERATION,\n  Aspect.RETRYABLE,\n  Aspect.EXECUTE_WITH_SELECTION,\n  Aspect.EXPLAINABLE\n]);\n\nmodule.exports = FindOperation;\n"],"names":["require$$0","require$$1","require$$2","require$$3"],"mappings":";;;;;AAEA,MAAM,aAAa,GAAGA,SAAsB,CAAC,aAAa,CAAC;AAC3D,MAAM,MAAM,GAAGA,SAAsB,CAAC,MAAM,CAAC;AAC7C,MAAM,aAAa,GAAGA,SAAsB,CAAC,aAAa,CAAC;AAC3D,MAAM,cAAc,GAAGC,IAAkB,CAAC,cAAc,CAAC;AACzD,MAAM,cAAc,GAAGC,KAAwB,CAAC,cAAc,CAAC;AAC/D,MAAM,UAAU,GAAGC,KAAwB,CAAC,UAAU,CAAC;AACvD;AACA,MAAM,aAAa,SAAS,aAAa,CAAC;AAC1C,EAAE,WAAW,CAAC,UAAU,EAAE,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE;AAChD,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;AACnB;AACA,IAAI,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;AACjB,IAAI,IAAI,CAAC,GAAG,GAAG,OAAO,CAAC;AACvB,IAAI,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AAC3E,GAAG;AACH;AACA,EAAE,OAAO,CAAC,MAAM,EAAE,QAAQ,EAAE;AAC5B;AACA,IAAI,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACzB;AACA;AACA,IAAI,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;AACrE;AACA,IAAI,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,YAAY,KAAK,WAAW,IAAI,cAAc,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE;AACpF,MAAM,QAAQ,CAAC,IAAI,UAAU,CAAC,6DAA6D,CAAC,CAAC,CAAC;AAC9F,MAAM,OAAO;AACb,KAAK;AACL;AACA,IAAI,IAAI,IAAI,CAAC,OAAO,EAAE;AACtB;AACA,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;AACpD,KAAK;AACL;AACA;AACA,IAAI,MAAM,WAAW,GAAG,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC;AAC/C,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,WAAW,EAAE,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;AACpF,GAAG;AACH,CAAC;AACD;AACA,aAAa,CAAC,aAAa,EAAE;AAC7B,EAAE,MAAM,CAAC,cAAc;AACvB,EAAE,MAAM,CAAC,SAAS;AAClB,EAAE,MAAM,CAAC,sBAAsB;AAC/B,EAAE,MAAM,CAAC,WAAW;AACpB,CAAC,CAAC,CAAC;AACH;QACc,GAAG;;;;"}
{"version":3,"file":"validate_collection.js","sources":["../../../../../../../node_modules/mongodb/lib/operations/validate_collection.js"],"sourcesContent":["'use strict';\n\nconst CommandOperation = require('./command');\n\nclass ValidateCollectionOperation extends CommandOperation {\n  constructor(admin, collectionName, options) {\n    // Decorate command with extra options\n    let command = { validate: collectionName };\n    const keys = Object.keys(options);\n    for (let i = 0; i < keys.length; i++) {\n      if (Object.prototype.hasOwnProperty.call(options, keys[i]) && keys[i] !== 'session') {\n        command[keys[i]] = options[keys[i]];\n      }\n    }\n\n    super(admin.s.db, options, null, command);\n    this.collectionName = collectionName;\n  }\n\n  execute(callback) {\n    const collectionName = this.collectionName;\n\n    super.execute((err, doc) => {\n      if (err != null) return callback(err, null);\n\n      if (doc.ok === 0) return callback(new Error('Error with validate command'), null);\n      if (doc.result != null && doc.result.constructor !== String)\n        return callback(new Error('Error with validation data'), null);\n      if (doc.result != null && doc.result.match(/exception|corrupt/) != null)\n        return callback(new Error('Error: invalid collection ' + collectionName), null);\n      if (doc.valid != null && !doc.valid)\n        return callback(new Error('Error: invalid collection ' + collectionName), null);\n\n      return callback(null, doc);\n    });\n  }\n}\n\nmodule.exports = ValidateCollectionOperation;\n"],"names":["CommandOperation"],"mappings":";;;;AAIA,MAAM,2BAA2B,SAASA,OAAgB,CAAC;AAC3D,EAAE,WAAW,CAAC,KAAK,EAAE,cAAc,EAAE,OAAO,EAAE;AAC9C;AACA,IAAI,IAAI,OAAO,GAAG,EAAE,QAAQ,EAAE,cAAc,EAAE,CAAC;AAC/C,IAAI,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACtC,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAC1C,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;AAC3F,QAAQ,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5C,OAAO;AACP,KAAK;AACL;AACA,IAAI,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;AAC9C,IAAI,IAAI,CAAC,cAAc,GAAG,cAAc,CAAC;AACzC,GAAG;AACH;AACA,EAAE,OAAO,CAAC,QAAQ,EAAE;AACpB,IAAI,MAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC;AAC/C;AACA,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,GAAG,KAAK;AAChC,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,OAAO,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;AAClD;AACA,MAAM,IAAI,GAAG,CAAC,EAAE,KAAK,CAAC,EAAE,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,6BAA6B,CAAC,EAAE,IAAI,CAAC,CAAC;AACxF,MAAM,IAAI,GAAG,CAAC,MAAM,IAAI,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,WAAW,KAAK,MAAM;AACjE,QAAQ,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,4BAA4B,CAAC,EAAE,IAAI,CAAC,CAAC;AACvE,MAAM,IAAI,GAAG,CAAC,MAAM,IAAI,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC,IAAI,IAAI;AAC7E,QAAQ,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,4BAA4B,GAAG,cAAc,CAAC,EAAE,IAAI,CAAC,CAAC;AACxF,MAAM,IAAI,GAAG,CAAC,KAAK,IAAI,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK;AACzC,QAAQ,OAAO,QAAQ,CAAC,IAAI,KAAK,CAAC,4BAA4B,GAAG,cAAc,CAAC,EAAE,IAAI,CAAC,CAAC;AACxF;AACA,MAAM,OAAO,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;AACjC,KAAK,CAAC,CAAC;AACP,GAAG;AACH,CAAC;AACD;uBACc,GAAG;;;;"}
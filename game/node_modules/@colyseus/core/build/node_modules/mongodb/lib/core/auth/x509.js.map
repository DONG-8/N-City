{"version":3,"file":"x509.js","sources":["../../../../../../../../node_modules/mongodb/lib/core/auth/x509.js"],"sourcesContent":["'use strict';\nconst AuthProvider = require('./auth_provider').AuthProvider;\n\nclass X509 extends AuthProvider {\n  prepare(handshakeDoc, authContext, callback) {\n    const credentials = authContext.credentials;\n    Object.assign(handshakeDoc, {\n      speculativeAuthenticate: x509AuthenticateCommand(credentials)\n    });\n\n    callback(undefined, handshakeDoc);\n  }\n\n  auth(authContext, callback) {\n    const connection = authContext.connection;\n    const credentials = authContext.credentials;\n    const response = authContext.response;\n    if (response.speculativeAuthenticate) {\n      return callback();\n    }\n\n    connection.command('$external.$cmd', x509AuthenticateCommand(credentials), callback);\n  }\n}\n\nfunction x509AuthenticateCommand(credentials) {\n  const command = { authenticate: 1, mechanism: 'MONGODB-X509' };\n  if (credentials.username) {\n    Object.assign(command, { user: credentials.username });\n  }\n\n  return command;\n}\n\nmodule.exports = X509;\n"],"names":["require$$0"],"mappings":";;;;AACA,MAAM,YAAY,GAAGA,aAA0B,CAAC,YAAY,CAAC;AAC7D;AACA,MAAM,IAAI,SAAS,YAAY,CAAC;AAChC,EAAE,OAAO,CAAC,YAAY,EAAE,WAAW,EAAE,QAAQ,EAAE;AAC/C,IAAI,MAAM,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;AAChD,IAAI,MAAM,CAAC,MAAM,CAAC,YAAY,EAAE;AAChC,MAAM,uBAAuB,EAAE,uBAAuB,CAAC,WAAW,CAAC;AACnE,KAAK,CAAC,CAAC;AACP;AACA,IAAI,QAAQ,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;AACtC,GAAG;AACH;AACA,EAAE,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE;AAC9B,IAAI,MAAM,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC;AAC9C,IAAI,MAAM,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC;AAChD,IAAI,MAAM,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC;AAC1C,IAAI,IAAI,QAAQ,CAAC,uBAAuB,EAAE;AAC1C,MAAM,OAAO,QAAQ,EAAE,CAAC;AACxB,KAAK;AACL;AACA,IAAI,UAAU,CAAC,OAAO,CAAC,gBAAgB,EAAE,uBAAuB,CAAC,WAAW,CAAC,EAAE,QAAQ,CAAC,CAAC;AACzF,GAAG;AACH,CAAC;AACD;AACA,SAAS,uBAAuB,CAAC,WAAW,EAAE;AAC9C,EAAE,MAAM,OAAO,GAAG,EAAE,YAAY,EAAE,CAAC,EAAE,SAAS,EAAE,cAAc,EAAE,CAAC;AACjE,EAAE,IAAI,WAAW,CAAC,QAAQ,EAAE;AAC5B,IAAI,MAAM,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,IAAI,EAAE,WAAW,CAAC,QAAQ,EAAE,CAAC,CAAC;AAC3D,GAAG;AACH;AACA,EAAE,OAAO,OAAO,CAAC;AACjB,CAAC;AACD;QACc,GAAG;;;;"}
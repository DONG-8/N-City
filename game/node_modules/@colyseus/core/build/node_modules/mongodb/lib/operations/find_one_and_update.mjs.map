{"version":3,"file":"find_one_and_update.mjs","sources":["../../../../../../../node_modules/mongodb/lib/operations/find_one_and_update.js"],"sourcesContent":["'use strict';\n\nconst MongoError = require('../core').MongoError;\nconst FindAndModifyOperation = require('./find_and_modify');\nconst hasAtomicOperators = require('../utils').hasAtomicOperators;\n\nclass FindOneAndUpdateOperation extends FindAndModifyOperation {\n  constructor(collection, filter, update, options) {\n    if ('returnDocument' in options && 'returnOriginal' in options) {\n      throw new MongoError(\n        'findOneAndUpdate option returnOriginal is deprecated in favor of returnDocument and cannot be combined'\n      );\n    }\n    // Final options\n    const finalOptions = Object.assign({}, options);\n    finalOptions.fields = options.projection;\n    finalOptions.update = true;\n    finalOptions.new = options.returnDocument === 'after' || options.returnOriginal === false;\n    finalOptions.upsert = options.upsert === true;\n\n    if (filter == null || typeof filter !== 'object') {\n      throw new TypeError('Filter parameter must be an object');\n    }\n\n    if (update == null || typeof update !== 'object') {\n      throw new TypeError('Update parameter must be an object');\n    }\n\n    if (!hasAtomicOperators(update)) {\n      throw new TypeError('Update document requires atomic operators');\n    }\n\n    super(collection, filter, finalOptions.sort, update, finalOptions);\n  }\n}\n\nmodule.exports = FindOneAndUpdateOperation;\n"],"names":["require$$0","require$$1","FindAndModifyOperation"],"mappings":";;;;AAEA,MAAM,UAAU,GAAGA,IAAkB,CAAC,UAAU,CAAC;AACW;AAC5D,MAAM,kBAAkB,GAAGC,KAAmB,CAAC,kBAAkB,CAAC;AAClE;AACA,MAAM,yBAAyB,SAASC,eAAsB,CAAC;AAC/D,EAAE,WAAW,CAAC,UAAU,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE;AACnD,IAAI,IAAI,gBAAgB,IAAI,OAAO,IAAI,gBAAgB,IAAI,OAAO,EAAE;AACpE,MAAM,MAAM,IAAI,UAAU;AAC1B,QAAQ,wGAAwG;AAChH,OAAO,CAAC;AACR,KAAK;AACL;AACA,IAAI,MAAM,YAAY,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;AACpD,IAAI,YAAY,CAAC,MAAM,GAAG,OAAO,CAAC,UAAU,CAAC;AAC7C,IAAI,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC;AAC/B,IAAI,YAAY,CAAC,GAAG,GAAG,OAAO,CAAC,cAAc,KAAK,OAAO,IAAI,OAAO,CAAC,cAAc,KAAK,KAAK,CAAC;AAC9F,IAAI,YAAY,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,KAAK,IAAI,CAAC;AAClD;AACA,IAAI,IAAI,MAAM,IAAI,IAAI,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;AACtD,MAAM,MAAM,IAAI,SAAS,CAAC,oCAAoC,CAAC,CAAC;AAChE,KAAK;AACL;AACA,IAAI,IAAI,MAAM,IAAI,IAAI,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;AACtD,MAAM,MAAM,IAAI,SAAS,CAAC,oCAAoC,CAAC,CAAC;AAChE,KAAK;AACL;AACA,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,EAAE;AACrC,MAAM,MAAM,IAAI,SAAS,CAAC,2CAA2C,CAAC,CAAC;AACvE,KAAK;AACL;AACA,IAAI,KAAK,CAAC,UAAU,EAAE,MAAM,EAAE,YAAY,CAAC,IAAI,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;AACvE,GAAG;AACH,CAAC;AACD;uBACc,GAAG;;;;"}
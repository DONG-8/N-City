{"version":3,"file":"list_indexes.js","sources":["../../../../../../../node_modules/mongodb/lib/operations/list_indexes.js"],"sourcesContent":["'use strict';\n\nconst CommandOperationV2 = require('./command_v2');\nconst Aspect = require('./operation').Aspect;\nconst defineAspects = require('./operation').defineAspects;\nconst maxWireVersion = require('../core/utils').maxWireVersion;\n\nconst LIST_INDEXES_WIRE_VERSION = 3;\n\nclass ListIndexesOperation extends CommandOperationV2 {\n  constructor(collection, options) {\n    super(collection, options, { fullResponse: true });\n\n    this.collectionNamespace = collection.s.namespace;\n  }\n\n  execute(server, callback) {\n    const serverWireVersion = maxWireVersion(server);\n    if (serverWireVersion < LIST_INDEXES_WIRE_VERSION) {\n      const systemIndexesNS = this.collectionNamespace.withCollection('system.indexes').toString();\n      const collectionNS = this.collectionNamespace.toString();\n\n      server.query(systemIndexesNS, { query: { ns: collectionNS } }, {}, this.options, callback);\n      return;\n    }\n\n    const cursor = this.options.batchSize ? { batchSize: this.options.batchSize } : {};\n    super.executeCommand(\n      server,\n      { listIndexes: this.collectionNamespace.collection, cursor },\n      callback\n    );\n  }\n}\n\ndefineAspects(ListIndexesOperation, [\n  Aspect.READ_OPERATION,\n  Aspect.RETRYABLE,\n  Aspect.EXECUTE_WITH_SELECTION\n]);\n\nmodule.exports = ListIndexesOperation;\n"],"names":["require$$0","require$$1","CommandOperationV2"],"mappings":";;;;;;AAGA,MAAM,MAAM,GAAGA,SAAsB,CAAC,MAAM,CAAC;AAC7C,MAAM,aAAa,GAAGA,SAAsB,CAAC,aAAa,CAAC;AAC3D,MAAM,cAAc,GAAGC,KAAwB,CAAC,cAAc,CAAC;AAC/D;AACA,MAAM,yBAAyB,GAAG,CAAC,CAAC;AACpC;AACA,MAAM,oBAAoB,SAASC,UAAkB,CAAC;AACtD,EAAE,WAAW,CAAC,UAAU,EAAE,OAAO,EAAE;AACnC,IAAI,KAAK,CAAC,UAAU,EAAE,OAAO,EAAE,EAAE,YAAY,EAAE,IAAI,EAAE,CAAC,CAAC;AACvD;AACA,IAAI,IAAI,CAAC,mBAAmB,GAAG,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC;AACtD,GAAG;AACH;AACA,EAAE,OAAO,CAAC,MAAM,EAAE,QAAQ,EAAE;AAC5B,IAAI,MAAM,iBAAiB,GAAG,cAAc,CAAC,MAAM,CAAC,CAAC;AACrD,IAAI,IAAI,iBAAiB,GAAG,yBAAyB,EAAE;AACvD,MAAM,MAAM,eAAe,GAAG,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC,gBAAgB,CAAC,CAAC,QAAQ,EAAE,CAAC;AACnG,MAAM,MAAM,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,CAAC;AAC/D;AACA,MAAM,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;AACjG,MAAM,OAAO;AACb,KAAK;AACL;AACA,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,GAAG,EAAE,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,GAAG,EAAE,CAAC;AACvF,IAAI,KAAK,CAAC,cAAc;AACxB,MAAM,MAAM;AACZ,MAAM,EAAE,WAAW,EAAE,IAAI,CAAC,mBAAmB,CAAC,UAAU,EAAE,MAAM,EAAE;AAClE,MAAM,QAAQ;AACd,KAAK,CAAC;AACN,GAAG;AACH,CAAC;AACD;AACA,aAAa,CAAC,oBAAoB,EAAE;AACpC,EAAE,MAAM,CAAC,cAAc;AACvB,EAAE,MAAM,CAAC,SAAS;AAClB,EAAE,MAAM,CAAC,sBAAsB;AAC/B,CAAC,CAAC,CAAC;AACH;gBACc,GAAG;;;;"}
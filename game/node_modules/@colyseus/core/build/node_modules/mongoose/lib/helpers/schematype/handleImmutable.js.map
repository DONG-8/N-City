{"version":3,"file":"handleImmutable.js","sources":["../../../../../../../../node_modules/mongoose/lib/helpers/schematype/handleImmutable.js"],"sourcesContent":["'use strict';\n\nconst StrictModeError = require('../../error/strict');\n\n/*!\n * ignore\n */\n\nmodule.exports = function(schematype) {\n  if (schematype.$immutable) {\n    schematype.$immutableSetter = createImmutableSetter(schematype.path,\n      schematype.options.immutable);\n    schematype.set(schematype.$immutableSetter);\n  } else if (schematype.$immutableSetter) {\n    schematype.setters = schematype.setters.\n      filter(fn => fn !== schematype.$immutableSetter);\n    delete schematype.$immutableSetter;\n  }\n};\n\nfunction createImmutableSetter(path, immutable) {\n  return function immutableSetter(v) {\n    if (this == null || this.$__ == null) {\n      return v;\n    }\n    if (this.isNew) {\n      return v;\n    }\n\n    const _immutable = typeof immutable === 'function' ?\n      immutable.call(this, this) :\n      immutable;\n    if (!_immutable) {\n      return v;\n    }\n\n    const _value = this.$__getValue(path);\n    if (this.$__.strictMode === 'throw' && v !== _value) {\n      throw new StrictModeError(path, 'Path `' + path + '` is immutable ' +\n        'and strict mode is set to throw.', true);\n    }\n\n    return _value;\n  };\n}\n"],"names":["StrictModeError"],"mappings":";;;;AAIA;AACA;AACA;AACA;mBACc,GAAG,SAAS,UAAU,EAAE;AACtC,EAAE,IAAI,UAAU,CAAC,UAAU,EAAE;AAC7B,IAAI,UAAU,CAAC,gBAAgB,GAAG,qBAAqB,CAAC,UAAU,CAAC,IAAI;AACvE,MAAM,UAAU,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AACpC,IAAI,UAAU,CAAC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,CAAC;AAChD,GAAG,MAAM,IAAI,UAAU,CAAC,gBAAgB,EAAE;AAC1C,IAAI,UAAU,CAAC,OAAO,GAAG,UAAU,CAAC,OAAO;AAC3C,MAAM,MAAM,CAAC,EAAE,IAAI,EAAE,KAAK,UAAU,CAAC,gBAAgB,CAAC,CAAC;AACvD,IAAI,OAAO,UAAU,CAAC,gBAAgB,CAAC;AACvC,GAAG;AACH,EAAE;AACF;AACA,SAAS,qBAAqB,CAAC,IAAI,EAAE,SAAS,EAAE;AAChD,EAAE,OAAO,SAAS,eAAe,CAAC,CAAC,EAAE;AACrC,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE;AAC1C,MAAM,OAAO,CAAC,CAAC;AACf,KAAK;AACL,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE;AACpB,MAAM,OAAO,CAAC,CAAC;AACf,KAAK;AACL;AACA,IAAI,MAAM,UAAU,GAAG,OAAO,SAAS,KAAK,UAAU;AACtD,MAAM,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC;AAChC,MAAM,SAAS,CAAC;AAChB,IAAI,IAAI,CAAC,UAAU,EAAE;AACrB,MAAM,OAAO,CAAC,CAAC;AACf,KAAK;AACL;AACA,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;AAC1C,IAAI,IAAI,IAAI,CAAC,GAAG,CAAC,UAAU,KAAK,OAAO,IAAI,CAAC,KAAK,MAAM,EAAE;AACzD,MAAM,MAAM,IAAIA,MAAe,CAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,GAAG,iBAAiB;AACzE,QAAQ,kCAAkC,EAAE,IAAI,CAAC,CAAC;AAClD,KAAK;AACL;AACA,IAAI,OAAO,MAAM,CAAC;AAClB,GAAG,CAAC;AACJ;;;;"}
{"version":3,"file":"applyPlugins.js","sources":["../../../../../../../../node_modules/mongoose/lib/helpers/schema/applyPlugins.js"],"sourcesContent":["'use strict';\n\nmodule.exports = function applyPlugins(schema, plugins, options, cacheKey) {\n  if (schema[cacheKey]) {\n    return;\n  }\n  schema[cacheKey] = true;\n\n  if (!options || !options.skipTopLevel) {\n    for (const plugin of plugins) {\n      schema.plugin(plugin[0], plugin[1]);\n    }\n  }\n\n  options = Object.assign({}, options);\n  delete options.skipTopLevel;\n\n  if (options.applyPluginsToChildSchemas !== false) {\n    for (const path of Object.keys(schema.paths)) {\n      const type = schema.paths[path];\n      if (type.schema != null) {\n        applyPlugins(type.schema, plugins, options, cacheKey);\n\n        // Recompile schema because plugins may have changed it, see gh-7572\n        type.caster.prototype.$__setSchema(type.schema);\n      }\n    }\n  }\n\n  const discriminators = schema.discriminators;\n  if (discriminators == null) {\n    return;\n  }\n\n  const applyPluginsToDiscriminators = options.applyPluginsToDiscriminators;\n\n  const keys = Object.keys(discriminators);\n  for (const discriminatorKey of keys) {\n    const discriminatorSchema = discriminators[discriminatorKey];\n\n    applyPlugins(discriminatorSchema, plugins,\n      { skipTopLevel: !applyPluginsToDiscriminators }, cacheKey);\n  }\n};"],"names":[],"mappings":";;gBAEc,GAAG,SAAS,YAAY,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE;AAC3E,EAAE,IAAI,MAAM,CAAC,QAAQ,CAAC,EAAE;AACxB,IAAI,OAAO;AACX,GAAG;AACH,EAAE,MAAM,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;AAC1B;AACA,EAAE,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;AACzC,IAAI,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;AAClC,MAAM,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;AAC1C,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;AACvC,EAAE,OAAO,OAAO,CAAC,YAAY,CAAC;AAC9B;AACA,EAAE,IAAI,OAAO,CAAC,0BAA0B,KAAK,KAAK,EAAE;AACpD,IAAI,KAAK,MAAM,IAAI,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;AAClD,MAAM,MAAM,IAAI,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AACtC,MAAM,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,EAAE;AAC/B,QAAQ,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;AAC9D;AACA;AACA,QAAQ,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACxD,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA,EAAE,MAAM,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC;AAC/C,EAAE,IAAI,cAAc,IAAI,IAAI,EAAE;AAC9B,IAAI,OAAO;AACX,GAAG;AACH;AACA,EAAE,MAAM,4BAA4B,GAAG,OAAO,CAAC,4BAA4B,CAAC;AAC5E;AACA,EAAE,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;AAC3C,EAAE,KAAK,MAAM,gBAAgB,IAAI,IAAI,EAAE;AACvC,IAAI,MAAM,mBAAmB,GAAG,cAAc,CAAC,gBAAgB,CAAC,CAAC;AACjE;AACA,IAAI,YAAY,CAAC,mBAAmB,EAAE,OAAO;AAC7C,MAAM,EAAE,YAAY,EAAE,CAAC,4BAA4B,EAAE,EAAE,QAAQ,CAAC,CAAC;AACjE,GAAG;AACH;;;;"}
{"version":3,"file":"props.js","sources":["../../../../../../../node_modules/bluebird/js/release/props.js"],"sourcesContent":["\"use strict\";\nmodule.exports = function(\n    Promise, PromiseArray, tryConvertToPromise, apiRejection) {\nvar util = require(\"./util\");\nvar isObject = util.isObject;\nvar es5 = require(\"./es5\");\nvar Es6Map;\nif (typeof Map === \"function\") Es6Map = Map;\n\nvar mapToEntries = (function() {\n    var index = 0;\n    var size = 0;\n\n    function extractEntry(value, key) {\n        this[index] = value;\n        this[index + size] = key;\n        index++;\n    }\n\n    return function mapToEntries(map) {\n        size = map.size;\n        index = 0;\n        var ret = new Array(map.size * 2);\n        map.forEach(extractEntry, ret);\n        return ret;\n    };\n})();\n\nvar entriesToMap = function(entries) {\n    var ret = new Es6Map();\n    var length = entries.length / 2 | 0;\n    for (var i = 0; i < length; ++i) {\n        var key = entries[length + i];\n        var value = entries[i];\n        ret.set(key, value);\n    }\n    return ret;\n};\n\nfunction PropertiesPromiseArray(obj) {\n    var isMap = false;\n    var entries;\n    if (Es6Map !== undefined && obj instanceof Es6Map) {\n        entries = mapToEntries(obj);\n        isMap = true;\n    } else {\n        var keys = es5.keys(obj);\n        var len = keys.length;\n        entries = new Array(len * 2);\n        for (var i = 0; i < len; ++i) {\n            var key = keys[i];\n            entries[i] = obj[key];\n            entries[i + len] = key;\n        }\n    }\n    this.constructor$(entries);\n    this._isMap = isMap;\n    this._init$(undefined, isMap ? -6 : -3);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init = function () {};\n\nPropertiesPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val;\n        if (this._isMap) {\n            val = entriesToMap(this._values);\n        } else {\n            val = {};\n            var keyOffset = this.length();\n            for (var i = 0, len = this.length(); i < len; ++i) {\n                val[this._values[i + keyOffset]] = this._values[i];\n            }\n        }\n        this._resolve(val);\n        return true;\n    }\n    return false;\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength = function (len) {\n    return len >> 1;\n};\n\nfunction props(promises) {\n    var ret;\n    var castValue = tryConvertToPromise(promises);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(\n            Promise.props, undefined, undefined, undefined, undefined);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 2);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function () {\n    return props(this);\n};\n\nPromise.props = function (promises) {\n    return props(promises);\n};\n};\n"],"names":["util","require$$0","es5","require$$1"],"mappings":"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"}
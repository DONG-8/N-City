{"version":3,"file":"async.js","sources":["../../../../../../../node_modules/bluebird/js/release/async.js"],"sourcesContent":["\"use strict\";\nvar firstLineError;\ntry {throw new Error(); } catch (e) {firstLineError = e;}\nvar schedule = require(\"./schedule\");\nvar Queue = require(\"./queue\");\nvar util = require(\"./util\");\n\nfunction Async() {\n    this._customScheduler = false;\n    this._isTickUsed = false;\n    this._lateQueue = new Queue(16);\n    this._normalQueue = new Queue(16);\n    this._haveDrainedQueues = false;\n    this._trampolineEnabled = true;\n    var self = this;\n    this.drainQueues = function () {\n        self._drainQueues();\n    };\n    this._schedule = schedule;\n}\n\nAsync.prototype.setScheduler = function(fn) {\n    var prev = this._schedule;\n    this._schedule = fn;\n    this._customScheduler = true;\n    return prev;\n};\n\nAsync.prototype.hasCustomScheduler = function() {\n    return this._customScheduler;\n};\n\nAsync.prototype.enableTrampoline = function() {\n    this._trampolineEnabled = true;\n};\n\nAsync.prototype.disableTrampolineIfNecessary = function() {\n    if (util.hasDevTools) {\n        this._trampolineEnabled = false;\n    }\n};\n\nAsync.prototype.haveItemsQueued = function () {\n    return this._isTickUsed || this._haveDrainedQueues;\n};\n\n\nAsync.prototype.fatalError = function(e, isNode) {\n    if (isNode) {\n        process.stderr.write(\"Fatal \" + (e instanceof Error ? e.stack : e) +\n            \"\\n\");\n        process.exit(2);\n    } else {\n        this.throwLater(e);\n    }\n};\n\nAsync.prototype.throwLater = function(fn, arg) {\n    if (arguments.length === 1) {\n        arg = fn;\n        fn = function () { throw arg; };\n    }\n    if (typeof setTimeout !== \"undefined\") {\n        setTimeout(function() {\n            fn(arg);\n        }, 0);\n    } else try {\n        this._schedule(function() {\n            fn(arg);\n        });\n    } catch (e) {\n        throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n};\n\nfunction AsyncInvokeLater(fn, receiver, arg) {\n    this._lateQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncInvoke(fn, receiver, arg) {\n    this._normalQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncSettlePromises(promise) {\n    this._normalQueue._pushOne(promise);\n    this._queueTick();\n}\n\nif (!util.hasDevTools) {\n    Async.prototype.invokeLater = AsyncInvokeLater;\n    Async.prototype.invoke = AsyncInvoke;\n    Async.prototype.settlePromises = AsyncSettlePromises;\n} else {\n    Async.prototype.invokeLater = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvokeLater.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                setTimeout(function() {\n                    fn.call(receiver, arg);\n                }, 100);\n            });\n        }\n    };\n\n    Async.prototype.invoke = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvoke.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                fn.call(receiver, arg);\n            });\n        }\n    };\n\n    Async.prototype.settlePromises = function(promise) {\n        if (this._trampolineEnabled) {\n            AsyncSettlePromises.call(this, promise);\n        } else {\n            this._schedule(function() {\n                promise._settlePromises();\n            });\n        }\n    };\n}\n\nAsync.prototype._drainQueue = function(queue) {\n    while (queue.length() > 0) {\n        var fn = queue.shift();\n        if (typeof fn !== \"function\") {\n            fn._settlePromises();\n            continue;\n        }\n        var receiver = queue.shift();\n        var arg = queue.shift();\n        fn.call(receiver, arg);\n    }\n};\n\nAsync.prototype._drainQueues = function () {\n    this._drainQueue(this._normalQueue);\n    this._reset();\n    this._haveDrainedQueues = true;\n    this._drainQueue(this._lateQueue);\n};\n\nAsync.prototype._queueTick = function () {\n    if (!this._isTickUsed) {\n        this._isTickUsed = true;\n        this._schedule(this.drainQueues);\n    }\n};\n\nAsync.prototype._reset = function () {\n    this._isTickUsed = false;\n};\n\nmodule.exports = Async;\nmodule.exports.firstLineError = firstLineError;\n"],"names":["Queue"],"mappings":"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"}
{"version":3,"file":"context.js","sources":["../../../../../../../node_modules/bluebird/js/release/context.js"],"sourcesContent":["\"use strict\";\nmodule.exports = function(Promise) {\nvar longStackTraces = false;\nvar contextStack = [];\n\nPromise.prototype._promiseCreated = function() {};\nPromise.prototype._pushContext = function() {};\nPromise.prototype._popContext = function() {return null;};\nPromise._peekContext = Promise.prototype._peekContext = function() {};\n\nfunction Context() {\n    this._trace = new Context.CapturedTrace(peekContext());\n}\nContext.prototype._pushContext = function () {\n    if (this._trace !== undefined) {\n        this._trace._promiseCreated = null;\n        contextStack.push(this._trace);\n    }\n};\n\nContext.prototype._popContext = function () {\n    if (this._trace !== undefined) {\n        var trace = contextStack.pop();\n        var ret = trace._promiseCreated;\n        trace._promiseCreated = null;\n        return ret;\n    }\n    return null;\n};\n\nfunction createContext() {\n    if (longStackTraces) return new Context();\n}\n\nfunction peekContext() {\n    var lastIndex = contextStack.length - 1;\n    if (lastIndex >= 0) {\n        return contextStack[lastIndex];\n    }\n    return undefined;\n}\nContext.CapturedTrace = null;\nContext.create = createContext;\nContext.deactivateLongStackTraces = function() {};\nContext.activateLongStackTraces = function() {\n    var Promise_pushContext = Promise.prototype._pushContext;\n    var Promise_popContext = Promise.prototype._popContext;\n    var Promise_PeekContext = Promise._peekContext;\n    var Promise_peekContext = Promise.prototype._peekContext;\n    var Promise_promiseCreated = Promise.prototype._promiseCreated;\n    Context.deactivateLongStackTraces = function() {\n        Promise.prototype._pushContext = Promise_pushContext;\n        Promise.prototype._popContext = Promise_popContext;\n        Promise._peekContext = Promise_PeekContext;\n        Promise.prototype._peekContext = Promise_peekContext;\n        Promise.prototype._promiseCreated = Promise_promiseCreated;\n        longStackTraces = false;\n    };\n    longStackTraces = true;\n    Promise.prototype._pushContext = Context.prototype._pushContext;\n    Promise.prototype._popContext = Context.prototype._popContext;\n    Promise._peekContext = Promise.prototype._peekContext = peekContext;\n    Promise.prototype._promiseCreated = function() {\n        var ctx = this._peekContext();\n        if (ctx && ctx._promiseCreated == null) ctx._promiseCreated = this;\n    };\n};\nreturn Context;\n};\n"],"names":[],"mappings":"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"}
{"version":3,"file":"thenables.js","sources":["../../../../../../../node_modules/bluebird/js/release/thenables.js"],"sourcesContent":["\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = require(\"./util\");\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction tryConvertToPromise(obj, context) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) return obj;\n        var then = getThen(obj);\n        if (then === errorObj) {\n            if (context) context._pushContext();\n            var ret = Promise.reject(then.e);\n            if (context) context._popContext();\n            return ret;\n        } else if (typeof then === \"function\") {\n            if (isAnyBluebirdPromise(obj)) {\n                var ret = new Promise(INTERNAL);\n                obj._then(\n                    ret._fulfill,\n                    ret._reject,\n                    undefined,\n                    ret,\n                    null\n                );\n                return ret;\n            }\n            return doThenable(obj, then, context);\n        }\n    }\n    return obj;\n}\n\nfunction doGetThen(obj) {\n    return obj.then;\n}\n\nfunction getThen(obj) {\n    try {\n        return doGetThen(obj);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    try {\n        return hasProp.call(obj, \"_promise0\");\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction doThenable(x, then, context) {\n    var promise = new Promise(INTERNAL);\n    var ret = promise;\n    if (context) context._pushContext();\n    promise._captureStackTrace();\n    if (context) context._popContext();\n    var synchronous = true;\n    var result = util.tryCatch(then).call(x, resolve, reject);\n    synchronous = false;\n\n    if (promise && result === errorObj) {\n        promise._rejectCallback(result.e, true, true);\n        promise = null;\n    }\n\n    function resolve(value) {\n        if (!promise) return;\n        promise._resolveCallback(value);\n        promise = null;\n    }\n\n    function reject(reason) {\n        if (!promise) return;\n        promise._rejectCallback(reason, synchronous, true);\n        promise = null;\n    }\n    return ret;\n}\n\nreturn tryConvertToPromise;\n};\n"],"names":["util","require$$0"],"mappings":"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"}
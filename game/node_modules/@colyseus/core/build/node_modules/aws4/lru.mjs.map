{"version":3,"file":"lru.mjs","sources":["../../../../../node_modules/aws4/lru.js"],"sourcesContent":["module.exports = function(size) {\n  return new LruCache(size)\n}\n\nfunction LruCache(size) {\n  this.capacity = size | 0\n  this.map = Object.create(null)\n  this.list = new DoublyLinkedList()\n}\n\nLruCache.prototype.get = function(key) {\n  var node = this.map[key]\n  if (node == null) return undefined\n  this.used(node)\n  return node.val\n}\n\nLruCache.prototype.set = function(key, val) {\n  var node = this.map[key]\n  if (node != null) {\n    node.val = val\n  } else {\n    if (!this.capacity) this.prune()\n    if (!this.capacity) return false\n    node = new DoublyLinkedNode(key, val)\n    this.map[key] = node\n    this.capacity--\n  }\n  this.used(node)\n  return true\n}\n\nLruCache.prototype.used = function(node) {\n  this.list.moveToFront(node)\n}\n\nLruCache.prototype.prune = function() {\n  var node = this.list.pop()\n  if (node != null) {\n    delete this.map[node.key]\n    this.capacity++\n  }\n}\n\n\nfunction DoublyLinkedList() {\n  this.firstNode = null\n  this.lastNode = null\n}\n\nDoublyLinkedList.prototype.moveToFront = function(node) {\n  if (this.firstNode == node) return\n\n  this.remove(node)\n\n  if (this.firstNode == null) {\n    this.firstNode = node\n    this.lastNode = node\n    node.prev = null\n    node.next = null\n  } else {\n    node.prev = null\n    node.next = this.firstNode\n    node.next.prev = node\n    this.firstNode = node\n  }\n}\n\nDoublyLinkedList.prototype.pop = function() {\n  var lastNode = this.lastNode\n  if (lastNode != null) {\n    this.remove(lastNode)\n  }\n  return lastNode\n}\n\nDoublyLinkedList.prototype.remove = function(node) {\n  if (this.firstNode == node) {\n    this.firstNode = node.next\n  } else if (node.prev != null) {\n    node.prev.next = node.next\n  }\n  if (this.lastNode == node) {\n    this.lastNode = node.prev\n  } else if (node.next != null) {\n    node.next.prev = node.prev\n  }\n}\n\n\nfunction DoublyLinkedNode(key, val) {\n  this.key = key\n  this.val = val\n  this.prev = null\n  this.next = null\n}\n"],"names":[],"mappings":"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"}